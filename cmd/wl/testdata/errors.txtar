# Error paths for wl CLI.

# Unknown command.
! exec wl blorp
stderr 'unknown command "blorp"'

# join with bad upstream format.
! exec wl join badformat
stderr 'invalid upstream path'

# join without DOLTHUB_TOKEN.
! exec wl join hop/wl-commons
stderr 'DOLTHUB_TOKEN'

# join with token but no org.
env DOLTHUB_TOKEN=fake-token
! exec wl join hop/wl-commons
stderr 'DOLTHUB_ORG'
env DOLTHUB_TOKEN=

# post missing --title.
! exec wl post
stderr 'required flag.*"title"'

# post with invalid type.
! exec wl post --title test --type invalid
stderr 'invalid type "invalid"'

# post with invalid effort.
! exec wl post --title test --effort huge
stderr 'invalid effort "huge"'

# post with invalid priority.
! exec wl post --title test --priority 9
stderr 'invalid priority 9'

# post not joined.
! exec wl post --title test
stderr 'not joined'

# claim with no args.
! exec wl claim
stderr 'accepts 1 arg'

# claim not joined.
! exec wl claim w-abc
stderr 'not joined'

# unclaim with no args.
! exec wl unclaim
stderr 'accepts 1 arg'

# unclaim not joined.
! exec wl unclaim w-abc
stderr 'not joined'

# done with no args.
! exec wl done
stderr 'accepts 1 arg'

# done missing --evidence.
! exec wl done w-abc
stderr 'required flag.*"evidence"'

# done not joined.
! exec wl done w-abc --evidence x
stderr 'not joined'

# accept with no args.
! exec wl accept
stderr 'accepts 1 arg'

# accept missing --quality.
! exec wl accept w-abc
stderr 'required flag.*"quality"'

# accept with invalid quality (too low).
! exec wl accept w-abc --quality 0
stderr 'invalid quality'

# accept with invalid quality (too high).
! exec wl accept w-abc --quality 6
stderr 'invalid quality'

# accept with invalid severity.
! exec wl accept w-abc --quality 3 --severity bad
stderr 'invalid severity'

# accept not joined.
! exec wl accept w-abc --quality 3
stderr 'not joined'

# reject with no args.
! exec wl reject
stderr 'accepts 1 arg'

# reject not joined.
! exec wl reject w-abc
stderr 'not joined'

# update with no args.
! exec wl update
stderr 'accepts 1 arg'

# update with no fields.
! exec wl update w-abc
stderr 'at least one field'

# update with invalid type.
! exec wl update w-abc --type bad
stderr 'invalid type'

# update with invalid effort.
! exec wl update w-abc --effort huge
stderr 'invalid effort'

# update with invalid priority.
! exec wl update w-abc --priority 9
stderr 'invalid priority'

# update not joined.
! exec wl update w-abc --title new
stderr 'not joined'

# delete with no args.
! exec wl delete
stderr 'accepts 1 arg'

# delete not joined.
! exec wl delete w-abc
stderr 'not joined'

# status with no args.
! exec wl status
stderr 'accepts 1 arg'

# status not joined.
! exec wl status w-abc
stderr 'not joined'

# review not joined.
! exec wl review
stderr 'not joined'

# review with branch not joined.
! exec wl review wl/some/branch
stderr 'not joined'

# merge with no args.
! exec wl merge
stderr 'accepts 1 arg'

# merge not joined.
! exec wl merge wl/some/branch
stderr 'not joined'

# config get not joined.
! exec wl config get mode
stderr 'not joined'

# config set not joined.
! exec wl config set mode pr
stderr 'not joined'

# config set invalid mode.
# (requires a joined wasteland to get past config loading, so we test the
# validation function via unit tests instead. This just confirms the key
# validation path.)
! exec wl config set badkey value
stderr 'unknown config key'

# leave not joined (no arg).
! exec wl leave
stderr 'not joined'

# leave not joined (explicit arg).
! exec wl leave hop/wl-commons
stderr 'not joined'
